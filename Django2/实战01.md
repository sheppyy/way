# 1. 虚拟环境 virtualenv

## 1.1 安装

```
pip intall virtualenv
```



## 1.2 创建虚拟环境

```
virtualenv 虚拟环境名称
virtualenv 虚拟环境名称 --python=python3.7
virtualenv 虚拟环境名称 --python='D:\ProgramData\Anaconda3\python.exe'
```



## 1.3 激活、退出虚拟环境

```
激活：
	D:\Work\Python\Envs\evnnane\Scripts\activate
退出：
	D:\Work\Python\Envs\evnnane\Scripts\deactivate
```



## 1.4 环境依赖

```
1. 导出环境依赖到文件
	pip freeze > requirements.txt
2. 安装环境依赖
	pip install -f requirements.txt
```





# 2. 搭建项目

## 2.1 使用pycharm创建项目



# 3. 本地配置 local_settings.py

```
原理：就是使用本地配置覆盖settings.py
本地配置的作用：
	1. 本地配置信息
	2. 给不同的运行环境提供配置
```

## 3.1 创建本地配置文件

- 在和settings.py同级目录下创建即可



## 3.2 在settings.py导入本地配置

```
try:
    from .local_settings import *
except ImportError:
    pass
```

## 3.3 在本地配置中写内容

```
LANGUAGE_CODE = 'zh-hans'
....
SMS = 666
```



注意：

	1. 若要在本地配置文件添加新的东西，也需要在settings.py里面创建，并赋一个初始值；
 	2. 

# 4. 在码云托管代码

代码托管：码云、github、gitlab



一、创建远程仓库

```
1. 登录码云：https://gitee.com/
2. 新建仓库
3. 输入仓库名称、仓库介绍
4. 公开
5. 创建
```

二、将本地仓库代码推到远程仓库

```
前提：
	git config --global user.name "你的码云昵称"
	git config --global user.email "你的码云邮箱"

1. 创建.gitignore文件，告诉git要忽略的文件，即不推送的文件。
.gitignore的内容：
    # pycharm
    .idea/
    .DS_Store

    __pycache__/
    *.py[cod]
    *$py.class

    # Django stuff:
    local_settings.py
    *.sqlite3
    media/

    # database migrations
    */migrations/*.py
    !*/migrations/__init__.py

2. 在项目根目录初始化git
	git inti

3. 将本地文件添加到待提交仓库
	git add .

4. 提交到本地仓库
	git commit -m 'firt commit'

5. 本地仓库提交到远程仓库
    1. 建立关联关系，取别名
    git remote add origin https://gitee.com/passingyourvegetablefield/test01.git
    2. 推送
    git push -u origin master
```

三、拉取代码

```
git clone https://gitee.com/passingyourvegetablefield/test01.git
```



# 5. 使用腾讯短信服务发短信

## 5.1 使用短信的地方

1. 注册
2. 登录
3. 验证

## 5.2 注册腾讯短信服务



## 5.3 安装短信SDK&发送短信

前提：信息都审核通过了。



1. 安装SDK

```
pip install qcloudsms_py
```

2. 基于SDK发送短信

```

```



## 5.4 





# 6. Redis操作

## 6.1 安装和操作

https://pythonav.com/wiki/detail/10/82/



## 6.2 操作Redis库 

1. **安装库**

```
1. pip isntall redis
2. pip install django-redis
```

2. **连接方式**

   - **直接连接**

   ```
   import redis
   conn = redis.Redis(host='10.211.55.28', port=6379, password='foobared', encoding='utf-8')
   conn.set('110', 9999, ex=10)
   value = conn.get('15131255089')
   print(value)
   ```

   - **连接池**

   ```
   import redis
   pool = redis.ConnectionPool(host='10.211.55.28', port=6379, password='foobared', encoding='utf-8', max_connections=1000)
   conn = redis.Redis(connection_pool=pool)
   conn.set('name', "value", ex=10)
   value = conn.get('name')
   print(value)
   ```

   - **使用django连接redis**

   ```
   import redis
   from django.shortcuts import HttpResponse
   POOL = redis.ConnectionPool(host='10.211.55.28', port=6379, password='foobared', encoding='utf-8', max_connections=1000)
   def index(request):
       conn = redis.Redis(connection_pool=POOL)
       conn.set('name', "value", ex=10)
       value = conn.get('name')
       print(value)
       return HttpResponse("ok")
   ```

   - **在django中推荐的方式**

   ```
   1.在django项目的settings.py中添加相关配置
   
       # 上面是django项目settings中的其他配置....
       CACHES = {
           "default": {
               "BACKEND": "django_redis.cache.RedisCache",
               "LOCATION": "redis://10.211.55.28:6379",
               "OPTIONS": {
                   "CLIENT_CLASS": "django_redis.client.DefaultClient",
                   "CONNECTION_POOL_KWARGS": {
                       "max_connections": 1000,
                       "encoding": 'utf-8'
                   },
                   "PASSWORD": "foobared"
               }
           }
       }
       
   2. 在django的视图中操作redis
   
       from django.shortcuts import HttpResponse
       from django_redis import get_redis_connection
       
       def index(request):
           conn = get_redis_connection("default")
           conn.set('nickname', "value", ex=10)
           value = conn.get('nickname')
           print(value)
           return HttpResponse("OK")
   ```

   









# 7. 使用python生成图片并在图片说明写文字：图片验证码

## 7.1 安装库

```
pip install pillow
```

https://www.cnblogs.com/wupeiqi/articles/5812291.html







# 8.django离线脚本

```
离线脚本：即在非项目运行时，执行的程序
脚本：一个或多个py文件
```

1. 要想在django执行离线脚本，实现相应的功能，需要先加载django的环境





# 9.数据表

### 1 价格策略

| id   | 分类 | 标题     | 价格/年 | 项目个数 | 成员数/项目 | 项目空间/G | 单个文件 | 创建时间 |      |
| ---- | ---- | -------- | ------- | -------- | ----------- | ---------- | -------- | -------- | ---- |
| 1    | 免费 | 个人免费 | 0       | 5        | 5           | 10         | 2M       |          |      |
| 2    | 收费 | VIP      | 199     | 20       | 100         | 50         | 500M     |          |      |
| 3    | 收费 | SVIP     | 299     | 50       | 200         | 100        | G1       |          |      |
| 4    | 其他 |          |         |          |             |            |          |          |      |

当新用户注册，则给免费额度



### 2 用户

| id   | 姓名 | 手机   | 密码   |
| ---- | ---- | ------ | ------ |
| 1    | ydc1 | 110*** | 112121 |
| 2    | ydc2 | 120*** | 16552  |

### 3 交易

| id   | 状态   | 用户 | 价格 | 实际付款 | 开始时间 | 结束时间 | 数量/年 |      |      |
| ---- | ------ | ---- | ---- | -------- | -------- | -------- | ------- | ---- | ---- |
| 1    | 已支付 | 1    | 1    | 0        | 2020-8-1 | null     | 0       |      |      |
| 2    | 已支付 | 2    | 1    | 0        | 2020-8-1 | null     | 0       |      |      |
| 3    | 已支付 | 3    | 1    | 0        | 2020-8-1 | null     | 0       |      |      |
| 4    | 已支付 | 2    | 2    | 199      | 2020-8-1 | 2021-8-1 | 1       |      |      |
| 5    | 已支付 | 3    | 3    | 299*1    | 2020-8-1 | 2022-8-1 | 2       |      |      |
|      |        |      |      |          |          |          |         |      |      |

















**注意：**

​		

```
1. django找模板的顺序：是先找根目录下的templates,再根据注册app的顺序，找对应app里面的templates
2. django在的数据模型的字段，在MoDelForm内可以覆盖修改，在页面显示会改变
3. 验证码不需要长期保存，使用redis数据库保存，并设置失效时间
4. 各个app都应该在内部创建templates文件夹，并在templates文件夹里面创建与app同名的文件夹存放本app的所有模板；公共模板则放在根目录下的templates文件夹。
5. django中的模板继承语句必须在第一行，{% extends 'layout/basic.html' %}
6. 可以使用构造函数将外部对象传递到类内部使用。
7. django中的session有效期为两周

```

